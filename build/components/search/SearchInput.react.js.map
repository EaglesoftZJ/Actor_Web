{"version":3,"sources":["../../../src/components/search/SearchInput.react.js"],"names":["SearchInput","props","handleFocus","bind","handleChange","handleKeyDown","handleGlobalClick","componentDidMount","listeners","listen","document","componentWillUnmount","forEach","listener","remove","event","isFocused","target","refs","search","onBlur","preventDefault","stopPropagation","onFocus","onChange","value","keyCode","K","metaKey","ctrlKey","focus","ESC","onClear","renderClear","render","intl","context","messages","activeElement","contextTypes","object","isRequired","propTypes","string","bool","func"],"mappings":"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","file":"SearchInput.react.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport EventListener from 'fbjs/lib/EventListener';\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nclass SearchInput extends Component {\n  static contextTypes = {\n    intl: PropTypes.object.isRequired\n  };\n\n  static propTypes = {\n    value: PropTypes.string.isRequired,\n    isFocused: PropTypes.bool.isRequired,\n    onBlur: PropTypes.func.isRequired,\n    onFocus: PropTypes.func.isRequired,\n    onClear: PropTypes.func.isRequired,\n    onChange: PropTypes.func.isRequired\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.handleFocus = this.handleFocus.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleGlobalClick = this.handleGlobalClick.bind(this);\n  }\n\n  componentDidMount() {\n    this.listeners = [\n      EventListener.listen(document, 'keydown', this.handleKeyDown),\n      EventListener.listen(document, 'click', this.handleGlobalClick)\n    ];\n  }\n\n  componentWillUnmount() {\n    this.listeners.forEach((listener) => listener.remove());\n    this.listeners = null;\n  }\n\n  handleGlobalClick(event) {\n   if (this.props.isFocused && event.target !== this.refs.search) {\n     this.props.onBlur();\n   }\n }\n\n  handleFocus(event) {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this.props.onFocus();\n  }\n\n  handleChange(event) {\n    this.props.onChange(event.target.value);\n  }\n\n  handleKeyDown(event) {\n    if (event.keyCode === KeyCodes.K && (event.metaKey || event.ctrlKey)) {\n      event.preventDefault();\n      this.focus();\n    }\n\n    if (event.keyCode === KeyCodes.ESC && this.isFocused()) {\n      event.preventDefault();\n      this.props.onClear();\n    }\n  }\n\n  renderClear() {\n    if (!this.props.value) {\n      return null;\n    }\n\n    return (\n      <i className=\"close-icon material-icons\" onClick={this.props.onClear}>close</i>\n    );\n  }\n\n  render() {\n    const { value } = this.props;\n    const { intl } = this.context;\n\n    return (\n      <div className=\"row toolbar__search__input col-xs\">\n        <input\n          className=\"input input--search col-xs\"\n          type=\"search\"\n          ref=\"search\"\n          tabIndex=\"1\"\n          value={value}\n          placeholder={intl.messages['search.placeholder']}\n          onFocus={this.props.onFocus}\n          onChange={this.handleChange}\n        />\n        {this.renderClear()}\n      </div>\n    );\n  }\n\n  focus() {\n    if (this.refs.search) {\n      this.refs.search.focus();\n    }\n  }\n\n  isFocused() {\n    return document.activeElement === this.refs.search;\n  }\n}\n\nexport default SearchInput;\n"]}