{"version":3,"sources":["../../../src/components/activity/GroupMember.react.js"],"names":["GroupMember","props","onClick","id","selectDialogPeerUser","onKick","gid","uid","peerInfo","name","title","then","kickMember","getStores","calculateState","prevState","nextProps","kickUserState","getKickUserState","peer","renderControls","canKick","adminId","state","myId","getUid","render","avatar","placeholder","__html","propTypes","object","isRequired","bool","number","create","pure","withProps"],"mappings":"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","file":"GroupMember.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport { FormattedMessage } from 'react-intl';\nimport confirm from '../../utils/confirm'\nimport { escapeWithEmoji } from '../../utils/EmojiUtils'\nimport ActorClient from '../../utils/ActorClient'\n\nimport DialogActionCreators from '../../actions/DialogActionCreators';\nimport KickUserActionCreators from '../../actions/KickUserActionCreators';\n\nimport KickUserStore from '../../stores/KickUserStore'\n\nimport AvatarItem from '../common/AvatarItem.react';\nimport Stateful from '../common/Stateful.react';\n\nclass GroupMember extends Component {\n  constructor(props) {\n    super(props);\n  }\n\n  static propTypes = {\n    peerInfo: PropTypes.object.isRequired,\n    canKick: PropTypes.bool.isRequired, // 是否可以踢人\n    adminId: PropTypes.number, // 当前登录用户是否群组\n    gid: PropTypes.number.isRequired\n  };\n\n  static getStores() {\n    return [KickUserStore];\n  }\n\n  static calculateState(prevState, nextProps) {\n    return {\n      kickUserState: KickUserStore.getKickUserState(nextProps.peerInfo.peer.id)\n    };\n  }\n\n  onClick = (id) => DialogActionCreators.selectDialogPeerUser(id);\n\n  onKick = (gid, uid) => {\n    const { peerInfo } = this.props;\n\n    confirm(<FormattedMessage id=\"modal.confirm.kick\" values={{ name: peerInfo.title }}/>).then(\n      () => KickUserActionCreators.kickMember(gid, uid),\n      () => {}\n    );\n  };\n\n  renderControls() {\n    const { peerInfo, canKick, adminId, gid } = this.props;\n    const { kickUserState } = this.state;\n    const myId = ActorClient.getUid();\n\n    if (!canKick && adminId !== myId || peerInfo.peer.id === myId) return <div/>;\n    // if (peerInfo.peer.id === myId) return <div/>;\n\n    return (\n      <Stateful\n        currentState={kickUserState}\n        pending={<a onClick={() => this.onKick(gid, peerInfo.peer.id)}><FormattedMessage id=\"kick\"/></a>}\n        processing={<i className=\"material-icons spin\">autorenew</i>}\n        success={<i className=\"material-icons\">check</i>}\n        failure={<i className=\"material-icons\">warning</i>}\n      />\n    );\n  }\n\n\n  render() {\n    const { peerInfo } = this.props;\n\n    return (\n      <li className=\"group_profile__members__list__item\">\n        <AvatarItem\n          className=\"group_profile__avatar\"\n          image={peerInfo.avatar}\n          placeholder={peerInfo.placeholder}\n          title={peerInfo.title}\n          onClick={() => this.onClick(peerInfo.peer.id)}\n        />\n\n        <a onClick={() => this.onClick(peerInfo.peer.id)}\n           dangerouslySetInnerHTML={{ __html: escapeWithEmoji(peerInfo.title) }}/>\n\n        <div className=\"controls pull-right\">\n          {this.renderControls()}\n        </div>\n      </li>\n    )\n  }\n}\n\nexport default Container.create(GroupMember, { pure: false, withProps: true });\n"]}