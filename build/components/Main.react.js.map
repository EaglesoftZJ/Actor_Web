{"version":3,"sources":["../../src/components/Main.react.js"],"names":["Main","props","onVisibilityChange","document","hidden","createAppHidden","createAppVisible","components","getComponents","get","Sidebar","sidebar","Toolbar","toolbar","componentDidMount","isElectron","window","messenger","listenOnRender","event","arg","push","addEventListener","componentWillUnmount","removeEventListener","renderCall","features","calls","render","children","propTypes","params","object","oneOfType","arrayOf","node"],"mappings":";;;;AAGA;;AACA;;;;AACA;;;;AAEA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;;;;;;;+eApBA;;;;;IAsBMA,I;;;AASJ,gBAAYC,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAMA,KAAN,CADiB;;AAAA,UA2CnBC,kBA3CmB,GA2CE,YAAM;AACzB,UAAIC,SAASC,MAAb,EAAqB;AACnB,2CAAyBC,eAAzB;AACD,OAFD,MAEO;AACL,2CAAyBC,gBAAzB;AACD;AACF,KAjDkB;;AAGjB,UAAKC,UAAL,GAAkB,MAAKC,aAAL,EAAlB;AAHiB;AAIlB;;iBAEDA,a,4BAAgB;AAAA,gCACS,4BAAkBC,GAAlB,EADT;AAAA,QACNF,UADM,yBACNA,UADM;;AAGd,QAAIA,UAAJ,EAAgB;AACd,aAAO;AACLG,iBAAS,wBAAWH,WAAWI,OAAtB,IAAiCJ,WAAWI,OAA5C,oBADJ;AAELC,iBAAS,wBAAWL,WAAWM,OAAtB,IAAiCN,WAAWM,OAA5C;AAFJ,OAAP;AAID;;AAED,WAAO;AACLH,gCADK;AAELE;AAFK,KAAP;AAID,G;;iBAEDE,iB,gCAAoB;AAClB,SAAKZ,kBAAL;AACA,QAAI,sBAAYa,UAAZ,EAAJ,EAA8B;AAC5BC,aAAOC,SAAP,CAAiBC,cAAjB,CAAgC,cAAhC,EAAgD,UAASC,KAAT,EAAgBC,GAAhB,EAAqB;AACnE,0BAAQC,IAAR,CAAa,KAAb;AACD,OAFD;;AAIAL,aAAOC,SAAP,CAAiBC,cAAjB,CAAgC,eAAhC,EAAiD,UAASC,KAAT,EAAgBC,GAAhB,EAAqB;;AAEpE,0BAAQC,IAAR,UAAoBD,GAApB;AACD,OAHD;AAID,KATD,MASO;AACLjB,eAASmB,gBAAT,CAA0B,kBAA1B,EAA8C,KAAKpB,kBAAnD;AAED;AACF,G;;iBAEDqB,oB,mCAAuB;AACrBpB,aAASqB,mBAAT,CAA6B,kBAA7B,EAAiD,KAAKtB,kBAAtD;AACD,G;;iBAUDuB,U,yBAAa;AAAA,iCACU,4BAAkBhB,GAAlB,EADV;AAAA,QACHiB,QADG,0BACHA,QADG;;AAGX,QAAI,CAACA,SAASC,KAAd,EAAqB;AACnB,aAAO,IAAP;AACD;;AAED,WAAO,wDAAP;AACD,G;;iBAEDC,M,qBAAS;AAAA,sBACsB,KAAKrB,UAD3B;AAAA,QACCG,OADD,eACCA,OADD;AAAA,QACUE,OADV,eACUA,OADV;;;AAGP,WACE;AAAA;AAAA,QAAK,WAAU,KAAf;AACE,oEADF;AAEE,4DAFF;AAIE,oCAAC,OAAD,OAJF;AAKE;AAAA;AAAA,UAAS,WAAU,SAAnB;AACE,sCAAC,OAAD,OADF;AAEG,aAAKX,KAAL,CAAW4B;AAFd,OALF;AAWE,kEAXF;AAYE,gEAZF;AAcG,WAAKJ,UAAL;AAdH,KADF;AAkBD,G;;;;;AA3FGzB,I,CACG8B,S,GAAY;AACjBC,UAAQ,iBAAUC,MADD;AAEjBH,YAAU,iBAAUI,SAAV,CAAoB,CAC5B,iBAAUC,OAAV,CAAkB,iBAAUC,IAA5B,CAD4B,EAE5B,iBAAUA,IAFkB,CAApB;AAFO,C;kBA6FNnC,I","file":"Main.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\nimport { isFunction } from 'lodash';\r\nimport React, { Component, PropTypes } from 'react';\r\nimport DelegateContainer from '../utils/DelegateContainer';\r\n\r\nimport VisibilityActionCreators from '../actions/VisibilityActionCreators';\r\n\r\nimport DefaultSidebar from './Sidebar.react';\r\nimport DefaultToolbar from './Toolbar.react';\r\nimport ConnectionState from './common/ConnectionState.react';\r\nimport Favicon from './common/Favicon.react';\r\n\r\nimport ModalsWrapper from './modals/ModalsWrapper.react';\r\nimport MenuOverlay from './common/MenuOverlay.react';\r\nimport SmallCall from './SmallCall.react';\r\nimport loading from '../utils/DataLoading';\r\nimport ActorClient from '../utils/ActorClient';\r\n\r\nimport history from '../utils/history';\r\n\r\nclass Main extends Component {\r\n  static propTypes = {\r\n    params: PropTypes.object,\r\n    children: PropTypes.oneOfType([\r\n      PropTypes.arrayOf(PropTypes.node),\r\n      PropTypes.node\r\n    ])\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.components = this.getComponents();\r\n  }\r\n\r\n  getComponents() {\r\n    const { components } = DelegateContainer.get();\r\n\r\n    if (components) {\r\n      return {\r\n        Sidebar: isFunction(components.sidebar) ? components.sidebar : DefaultSidebar,\r\n        Toolbar: isFunction(components.toolbar) ? components.toolbar : DefaultToolbar\r\n      };\r\n    }\r\n\r\n    return {\r\n      Sidebar: DefaultSidebar,\r\n      Toolbar: DefaultToolbar\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.onVisibilityChange();\r\n    if (ActorClient.isElectron()) {\r\n      window.messenger.listenOnRender('windows-blur', function(event, arg) {\r\n        history.push('/im');\r\n      })\r\n\r\n      window.messenger.listenOnRender('windows-focus', function(event, arg) {\r\n\r\n        history.push(`/im/${arg}`);\r\n      })\r\n    } else {\r\n      document.addEventListener('visibilitychange', this.onVisibilityChange);\r\n\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener('visibilitychange', this.onVisibilityChange);\r\n  }\r\n\r\n  onVisibilityChange = () => {\r\n    if (document.hidden) {\r\n      VisibilityActionCreators.createAppHidden();\r\n    } else {\r\n      VisibilityActionCreators.createAppVisible();\r\n    }\r\n  };\r\n\r\n  renderCall() {\r\n    const { features } = DelegateContainer.get();\r\n\r\n    if (!features.calls) {\r\n      return null;\r\n    }\r\n\r\n    return <SmallCall />;\r\n  }\r\n\r\n  render() {\r\n    const { Sidebar, Toolbar } = this.components;\r\n\r\n    return (\r\n      <div className=\"app\">\r\n        <ConnectionState />\r\n        <Favicon />\r\n\r\n        <Toolbar />\r\n        <section className=\"wrapper\">\r\n          <Sidebar />\r\n          {this.props.children}\r\n        </section>\r\n\r\n\r\n        <ModalsWrapper />\r\n        <MenuOverlay />\r\n\r\n        {this.renderCall()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Main;\r\n"]}