{"version":3,"sources":["../../../src/components/modals/Attachments.react.js"],"names":["Attachments","getStores","calculateState","attachments","getAllAttachments","selectedIndex","getSelectedIndex","props","handleClose","bind","handleKeyDown","handleSelect","handleCancel","handleSend","handleSendAll","componentWillMount","document","addEventListener","componentDidMount","refs","send","focus","componentWillUnmount","removeEventListener","hide","event","keyCode","ENTER","preventDefault","shiftKey","index","selectAttachment","deleteAttachment","sendAttachment","sendAll","state","renderHeaderButton","length","renderAttachment","renderPagination","renderControls","render","create"],"mappings":";;;;AAIA;;;;AACA;;AACA;;AACA;;AACA;;;;AAEA;;AAEA;;;;AAEA;;;;AAEA;;;;AACA;;;;;;;;;;+eAjBA;;;;IAmBMA,W;;;cACGC,S,wBAAY;AACjB,WAAO,4BAAP;AACD,G;;cAEMC,c,6BAAiB;AACtB,WAAO;AACLC,mBAAa,2BAAiBC,iBAAjB,EADR;AAELC,qBAAe,2BAAiBC,gBAAjB;AAFV,KAAP;AAID,G;;AAED,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA,iDACjB,sBAAMA,KAAN,CADiB;;AAGjB,UAAKC,WAAL,GAAmB,MAAKA,WAAL,CAAiBC,IAAjB,OAAnB;AACA,UAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBD,IAAnB,OAArB;AACA,UAAKE,YAAL,GAAoB,MAAKA,YAAL,CAAkBF,IAAlB,OAApB;AACA,UAAKG,YAAL,GAAoB,MAAKA,YAAL,CAAkBH,IAAlB,OAApB;AACA,UAAKI,UAAL,GAAkB,MAAKA,UAAL,CAAgBJ,IAAhB,OAAlB;AACA,UAAKK,aAAL,GAAqB,MAAKA,aAAL,CAAmBL,IAAnB,OAArB;AARiB;AASlB;;wBAEDM,kB,iCAAqB;AACnBC,aAASC,gBAAT,CAA0B,SAA1B,EAAqC,KAAKP,aAA1C,EAAyD,KAAzD;AACD,G;;wBAEDQ,iB,gCAAoB;AAClB,+BAAY,KAAKC,IAAL,CAAUC,IAAtB,EAA4BC,KAA5B;AACD,G;;wBAEDC,oB,mCAAuB;AACrBN,aAASO,mBAAT,CAA6B,SAA7B,EAAwC,KAAKb,aAA7C,EAA4D,KAA5D;AACD,G;;wBAEDF,W,0BAAc;AACZ,wCAA0BgB,IAA1B;AACD,G;;wBAEDd,a,0BAAce,K,EAAO;AACnB,QAAIA,MAAMC,OAAN,KAAkB,4BAASC,KAA/B,EAAsC;AACpCF,YAAMG,cAAN;AACA,UAAIH,MAAMI,QAAV,EAAoB;AAClB,aAAKf,aAAL;AACD,OAFD,MAEO;AACL,aAAKD,UAAL;AACD;AACF;AACF,G;;wBAEDF,Y,yBAAamB,K,EAAO;AAClB,wCAA0BC,gBAA1B,CAA2CD,KAA3C;AACD,G;;wBAEDlB,Y,2BAAe;AACb,wCAA0BoB,gBAA1B;AACD,G;;wBAEDnB,U,yBAAa;AACX,wCAA0BoB,cAA1B;AACD,G;;wBAEDnB,a,4BAAgB;AACd,wCAA0BoB,OAA1B,CAAkC,KAAKC,KAAL,CAAWhC,WAA7C;AACD,G;;wBAEDiC,kB,iCAAqB;AAAA,QACXjC,WADW,GACK,KAAKgC,KADV,CACXhC,WADW;;AAEnB,QAAIA,YAAYkC,MAAZ,IAAsB,CAA1B,EAA6B,OAAO,IAAP;;AAE7B,WACE;AAAA;AAAA,QAAQ,WAAU,0BAAlB,EAA6C,SAAS,KAAKvB,aAA3D;AACE,mEAAkB,IAAG,gBAArB;AADF,KADF;AAKD,G;;wBAEDwB,gB,+BAAmB;AAAA,iBACsB,KAAKH,KAD3B;AAAA,QACThC,WADS,UACTA,WADS;AAAA,QACIE,aADJ,UACIA,aADJ;;AAEjB,QAAIF,YAAYkC,MAAZ,KAAuB,CAA3B,EAA8B,OAAO,IAAP;;AAE9B,WACE,sDAAY,YAAYlC,YAAYE,aAAZ,CAAxB,GADF;AAGD,G;;wBAEDkC,gB,+BAAmB;AAAA,kBACsB,KAAKJ,KAD3B;AAAA,QACThC,WADS,WACTA,WADS;AAAA,QACIE,aADJ,WACIA,aADJ;;AAEjB,QAAIF,YAAYkC,MAAZ,IAAsB,CAA1B,EAA6B,OAAO,IAAP;;AAE7B,WACE;AAAA;AAAA,QAAK,WAAU,QAAf;AACE;AACE,iBAAShC,aADX;AAEE,eAAOF,YAAYkC,MAAZ,GAAqB,CAF9B;AAGE,kBAAU,KAAK1B;AAHjB;AADF,KADF;AASD,G;;wBAED6B,c,6BAAiB;AACf,WACE;AAAA;AAAA,QAAK,WAAU,mBAAf;AACE;AAAA;AAAA,UAAQ,WAAU,QAAlB,EAA2B,SAAS,KAAK5B,YAAzC;AACE,qEAAkB,IAAG,eAArB;AADF,OADF;AAIE;AAAA;AAAA,UAAQ,WAAU,sBAAlB,EAAyC,KAAI,MAA7C,EAAoD,SAAS,KAAKC,UAAlE;AACE,qEAAkB,IAAG,aAArB;AADF;AAJF,KADF;AAUD,G;;wBAED4B,M,qBAAS;AACP,WACE;AAAA;AAAA;AACE,0BAAiB,eADnB;AAEE,mBAAU,OAFZ;AAGE,wBAAgB,KAAKjC,WAHvB;AAIE,oBAJF;AAME;AAAA;AAAA,UAAK,WAAU,aAAf;AACE;AAAA;AAAA,YAAK,WAAU,gBAAf;AAEE;AAAA;AAAA,cAAQ,WAAU,eAAlB;AACE,yEAAkB,IAAG,yBAArB,EAA+C,SAAQ,IAAvD,GADF;AAEG,iBAAK4B,kBAAL;AAFH,WAFF;AAOE;AAAA;AAAA,cAAK,WAAU,aAAf;AACG,iBAAKE,gBAAL;AADH,WAPF;AAWE;AAAA;AAAA,cAAQ,WAAU,mBAAlB;AACG,iBAAKC,gBAAL,EADH;AAEG,iBAAKC,cAAL;AAFH;AAXF;AADF;AANF,KADF;AA6BD,G;;;;;kBAGY,iBAAUE,MAAV,CAAiB1C,WAAjB,C","file":"Attachments.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component } from 'react';\nimport { Container } from 'flux/utils';\nimport { findDOMNode } from 'react-dom';\nimport { FormattedMessage } from 'react-intl';\nimport Modal from 'react-modal';\n\nimport { KeyCodes } from '../../constants/ActorAppConstants';\n\nimport AttachmentsActionCreators from '../../actions/AttachmentsActionCreators';\n\nimport AttachmentsStore from '../../stores/AttachmentsStore';\n\nimport Attachment from './attachments/Attachment.react';\nimport Pagination from './attachments/Pagination.react';\n\nclass Attachments extends Component {\n  static getStores() {\n    return [AttachmentsStore];\n  }\n\n  static calculateState() {\n    return {\n      attachments: AttachmentsStore.getAllAttachments(),\n      selectedIndex: AttachmentsStore.getSelectedIndex()\n    }\n  }\n\n  constructor(props) {\n    super(props);\n\n    this.handleClose = this.handleClose.bind(this);\n    this.handleKeyDown = this.handleKeyDown.bind(this);\n    this.handleSelect = this.handleSelect.bind(this);\n    this.handleCancel = this.handleCancel.bind(this);\n    this.handleSend = this.handleSend.bind(this);\n    this.handleSendAll = this.handleSendAll.bind(this);\n  }\n\n  componentWillMount() {\n    document.addEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  componentDidMount() {\n    findDOMNode(this.refs.send).focus()\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener('keydown', this.handleKeyDown, false);\n  }\n\n  handleClose() {\n    AttachmentsActionCreators.hide();\n  }\n\n  handleKeyDown(event) {\n    if (event.keyCode === KeyCodes.ENTER) {\n      event.preventDefault();\n      if (event.shiftKey) {\n        this.handleSendAll();\n      } else {\n        this.handleSend();\n      }\n    }\n  }\n\n  handleSelect(index) {\n    AttachmentsActionCreators.selectAttachment(index);\n  }\n\n  handleCancel() {\n    AttachmentsActionCreators.deleteAttachment();\n  }\n\n  handleSend() {\n    AttachmentsActionCreators.sendAttachment();\n  }\n\n  handleSendAll() {\n    AttachmentsActionCreators.sendAll(this.state.attachments);\n  }\n\n  renderHeaderButton() {\n    const { attachments } = this.state;\n    if (attachments.length <= 1) return null;\n\n    return (\n      <button className=\"button button--lightblue\" onClick={this.handleSendAll}>\n        <FormattedMessage id=\"button.sendAll\"/>\n      </button>\n    );\n  }\n\n  renderAttachment() {\n    const { attachments, selectedIndex } = this.state;\n    if (attachments.length === 0) return null;\n\n    return (\n      <Attachment attachment={attachments[selectedIndex]}/>\n    );\n  }\n\n  renderPagination() {\n    const { attachments, selectedIndex } = this.state;\n    if (attachments.length <= 1) return null;\n\n    return (\n      <div className=\"col-xs\">\n        <Pagination\n          current={selectedIndex}\n          total={attachments.length - 1}\n          onChange={this.handleSelect}\n        />\n      </div>\n    );\n  }\n\n  renderControls() {\n    return (\n      <div className=\"col-xs text-right\">\n        <button className=\"button\" onClick={this.handleCancel}>\n          <FormattedMessage id=\"button.cancel\"/>\n        </button>\n        <button className=\"button button--rised\" ref=\"send\" onClick={this.handleSend}>\n          <FormattedMessage id=\"button.send\"/>\n        </button>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        overlayClassName=\"modal-overlay\"\n        className=\"modal\"\n        onRequestClose={this.handleClose}\n        isOpen>\n\n        <div className=\"attachments\">\n          <div className=\"modal__content\">\n\n            <header className=\"modal__header\">\n              <FormattedMessage id=\"modal.attachments.title\" tagName=\"h1\"/>\n              {this.renderHeaderButton()}\n            </header>\n\n            <div className=\"modal__body\">\n              {this.renderAttachment()}\n            </div>\n\n            <footer className=\"modal__footer row\">\n              {this.renderPagination()}\n              {this.renderControls()}\n            </footer>\n\n          </div>\n        </div>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(Attachments);\n"]}