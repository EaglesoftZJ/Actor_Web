{"version":3,"sources":["../../../src/components/modals/Invite.react.js"],"names":["InviteUser","getStores","calculateState","contacts","getState","group","users","props","context","handleClose","bind","onSearchChange","onContactSelect","onInviteUrlByClick","hide","uid","inviteUser","state","id","show","INVITE","event","setState","search","target","value","getContacts","filter","contact","score","name","renderContacts","length","map","isMember","currentState","SUCCESS","PENDING","onClick","console","log","contactClassName","renderSearch","intl","messages","inviteByLinkButton","render","contextTypes","object","create"],"mappings":"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","file":"Invite.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport Modal from 'react-modal';\nimport { Container } from 'flux/utils';\nimport fuzzaldrin from 'fuzzaldrin';\nimport classNames from 'classnames';\nimport { FormattedMessage } from 'react-intl';\n\nimport { AsyncActionStates, ModalTypes } from '../../constants/ActorAppConstants';\nimport { hasMember } from '../../utils/GroupUtils';\n\nimport InviteUserActions from '../../actions/InviteUserActions';\nimport InviteUserByLinkActions from '../../actions/InviteUserByLinkActions';\n\nimport PeopleStore from '../../stores/PeopleStore';\nimport InviteUserStore from '../../stores/InviteUserStore';\n\nimport ContactItem from '../common/ContactItem.react';\nimport Stateful from '../common/Stateful.react';\n\nclass InviteUser extends Component {\n  static getStores() {\n    return [InviteUserStore, PeopleStore];\n  }\n\n  static calculateState() {\n    return {\n      contacts: PeopleStore.getState(),\n      group: InviteUserStore.getState().group,\n      users: InviteUserStore.getState().users\n    };\n  }\n\n  static contextTypes = {\n    intl: PropTypes.object\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.handleClose = this.handleClose.bind(this);\n    this.onSearchChange = this.onSearchChange.bind(this);\n    this.onContactSelect = this.onContactSelect.bind(this);\n    this.onInviteUrlByClick = this.onInviteUrlByClick.bind(this);\n  }\n\n  handleClose() {\n    InviteUserActions.hide();\n  }\n\n  onContactSelect(uid) {\n    InviteUserActions.inviteUser(this.state.group.id, uid);\n  }\n\n  onInviteUrlByClick() {\n    const { group } = this.state;\n\n    InviteUserByLinkActions.show(group, ModalTypes.INVITE);\n  }\n\n  onSearchChange(event) {\n    this.setState({ search: event.target.value });\n  }\n\n  getContacts() {\n    const { contacts, search } = this.state;\n    if (!search) return contacts;\n\n    return contacts.filter((contact) => {\n      return fuzzaldrin.score(contact.name, search) > 0;\n    });\n  }\n\n  renderContacts() {\n    const { group, users } = this.state;\n    const contacts = this.getContacts();\n\n    if (!contacts.length) {\n      return (\n        <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n          <FormattedMessage id=\"invite.notFound\"/>\n        </li>\n      );\n    }\n\n    return contacts.map((contact) => {\n\n      const isMember = hasMember(group.id, contact.uid);\n      const currentState = isMember ? AsyncActionStates.SUCCESS : (users[contact.uid] || AsyncActionStates.PENDING);\n\n      const onClick = () => {\n        console.log(`%c Trying to invite \"${contact.name}\"(uid=${contact.uid}) to group ${group.id}`, 'color: #fd5c52');\n        this.onContactSelect(contact.uid)\n      };\n\n      const contactClassName = classNames({\n        'contact--disabled': currentState === AsyncActionStates.SUCCESS\n      });\n\n      return (\n        <ContactItem {...contact} className={contactClassName} key={contact.uid}>\n          <Stateful\n            currentState={currentState}\n            pending={<a className=\"material-icons\" onClick={onClick}>person_add</a>}\n            processing={<i className=\"material-icons spin\">autorenew</i>}\n            success={<i className=\"material-icons\">check</i>}\n            failure={<i className=\"material-icons\">warning</i>}\n          />\n        </ContactItem>\n      );\n    });\n  }\n\n  renderSearch() {\n    const { search } = this.state;\n    const { intl } = this.context;\n\n    return (\n      <div className=\"small-search\">\n        <i className=\"material-icons\">search</i>\n        <input className=\"input\"\n               onChange={this.onSearchChange}\n               ref=\"search\"\n               placeholder={intl.messages['invite.search']}\n               type=\"search\"\n               value={search}/>\n      </div>\n    );\n  }\n\n  inviteByLinkButton() {\n    return (\n      <a className=\"link link--blue\" onClick={this.onInviteUrlByClick}>\n        <i className=\"material-icons\">link</i>\n        <FormattedMessage id=\"invite.inviteByLink\"/>\n      </a>\n    );\n  }\n\n  render() {\n    return (\n      <Modal\n        overlayClassName=\"modal-overlay\"\n        className=\"modal\"\n        onRequestClose={this.handleClose}\n        isOpen>\n\n        <div className=\"invite\">\n          <div className=\"modal__content\">\n\n            <header className=\"modal__header\">\n              <i className=\"modal__header__icon material-icons\">person_add</i>\n              <FormattedMessage id=\"invite.title\" tagName=\"h1\"/>\n              <button className=\"button button--lightblue\" onClick={this.handleClose}>\n                <FormattedMessage id=\"button.done\"/>\n              </button>\n            </header>\n\n            <div className=\"modal__body\">\n              {this.renderSearch()}\n\n              {this.inviteByLinkButton()}\n\n              <ul className=\"contacts__list\">\n                {this.renderContacts()}\n              </ul>\n            </div>\n\n          </div>\n        </div>\n\n      </Modal>\n    );\n  }\n}\n\nexport default Container.create(InviteUser);\n"]}