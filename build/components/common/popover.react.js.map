{"version":3,"sources":["../../../src/components/common/popover.react.js"],"names":["Popover","componentDidMount","componentDidUpdate","isShow","props","resetPopoverPosition","componentWillReceiveProps","nextProps","state","left","top","node","popoverHeight","refs","popover","outerHeight","nodeTop","position","nodeLeft","nodeWidth","outerWidth","nodeHeight","toLeft","toTop","wTop","window","scrollTop","wBottom","height","setState","handleMouseMove","event","nativeEvent","stopImmediatePropagation","renderArrow","style","renderInfo","children","render","popoverClassName","propTypes","object","bool"],"mappings":"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","file":"popover.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component, PropTypes, Children } from 'react';\r\nimport { FormattedHTMLMessage } from 'react-intl';\r\nimport $ from 'jquery';\r\n\r\nimport classnames from 'classnames';\r\n\r\nclass Popover extends Component {\r\n  static propTypes = {\r\n    node: PropTypes.object,\r\n    isShow: PropTypes.bool\r\n  };\r\n  componentDidMount() {\r\n  }\r\n  componentDidUpdate() {\r\n    const { isShow } = this.props;\r\n    isShow && this.resetPopoverPosition();\r\n  }\r\n  componentWillReceiveProps (nextProps) {\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      left: 0,\r\n      top: 0\r\n    };\r\n  }\r\n\r\n  resetPopoverPosition() {\r\n    const { node } = this.props;\r\n    const { left, top } = this.state; \r\n    if (!node) return;\r\n    // this.setState({'left': 10, 'top': 10});\r\n    let popoverHeight = $(this.refs.popover).outerHeight();\r\n    let nodeTop = $(node).position().top;\r\n    let nodeLeft = $(node).position().left;\r\n    let nodeWidth = $(node).outerWidth(true);\r\n    let nodeHeight = $(node).outerHeight(true);\r\n    let toLeft = nodeLeft + nodeWidth + 10;\r\n    let toTop = nodeTop + nodeHeight - popoverHeight / 2 - nodeHeight / 2;\r\n    let wTop = $(window).scrollTop();\r\n    let wBottom = wTop + $(window).height();\r\n    if (left !== toLeft || top !== toTop) {\r\n      this.setState({'left': toLeft, 'top': toTop});\r\n    }\r\n  }\r\n\r\n  handleMouseMove(event) {\r\n    event.nativeEvent.stopImmediatePropagation();\r\n  }\r\n\r\n  renderArrow() {\r\n    const { node } = this.props;\r\n    let style = {\r\n      top: ($(this.refs.popover).outerHeight() / 2 - 10) + 'px' \r\n    };\r\n    return (\r\n      <div className=\"arrow\" style={style}></div>\r\n    )\r\n  }\r\n  renderInfo() {\r\n    const { children } = this.props;\r\n    if (!children) {\r\n      return <FormattedHTMLMessage id=\"modal.quickSearch.notHaveInfo\"/>\r\n    }\r\n    return children;\r\n  }\r\n\r\n  render() {\r\n    const { isShow } = this.props;\r\n    const { left, top } = this.state;\r\n    let popoverClassName = classnames('popover-con', {'hide': !isShow});\r\n   return (\r\n      <div ref=\"popover\" onMouseMove={this.handleMouseMove} className={popoverClassName} style={{left: left + 'px', top: top + 'px'}}>\r\n        { this.renderInfo() }\r\n        { this.renderArrow() }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Popover;\r\n"]}