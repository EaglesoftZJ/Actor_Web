{"version":3,"sources":["../../src/actions/DialogInfoActionCreators.js"],"names":["DialogInfoActionCreators","setDialogInfo","info","DIALOG_INFO_CHANGED","peer","getCurrentPeer","type","GROUP","loadMembers","id","then","data","members","length","adminId","from","where","toArray","peerInfo"],"mappings":";;;;AAIA;;AACA;;AAEA;;;;AAEA;;;;AACA;;;;;;AAEA,IAAMA,2BAA2B;AAC/BC,eAD+B,yBACjBC,IADiB,EACX;AAClB,sCAAS,+BAAYC,mBAArB,EAA0C,EAAED,UAAF,EAA1C;;AAIA,QAAIE,OAAO,sBAAYC,cAAZ,EAAX;AACA,QAAID,QAAQA,KAAKE,IAAL,KAAc,6BAAUC,KAApC,EAA2C;AACzC,4BAAYC,WAAZ,CAAwBN,KAAKO,EAA7B,EAAiC,KAAjC,EAAwC,IAAxC,EAA8CC,IAA9C,CAAmD,UAACC,IAAD,EAAU;AAC3D,YAAGT,KAAKU,OAAL,IAAgBV,KAAKU,OAAL,CAAaC,MAAb,GAAsB,CAAzC,EAA4C;AAC1CX,eAAKU,OAAL,GAAeD,KAAKC,OAApB;AACAV,eAAKY,OAAL,GAAe,eAAKC,IAAL,CAAUb,KAAKU,OAAf,EAAwBI,KAAxB,CAA8B,oBAA9B,EAAoDC,OAApD,GAA8D,CAA9D,EAAiEC,QAAjE,CAA0Ed,IAA1E,CAA+EK,EAA9F;AACA,4CAAS,+BAAYN,mBAArB,EAA0C,EAAED,UAAF,EAA1C;AACD;AACF,OAND;AAOD;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD;AAlC8B,CAAjC,C,CAZA;;;;kBAiDeF,wB","file":"DialogInfoActionCreators.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport { dispatch } from '../dispatcher/ActorAppDispatcher';\nimport { ActionTypes, PeerTypes } from '../constants/ActorAppConstants';\n\nimport ActorClient from '../utils/ActorClient';\n\nimport DialogStore from '../stores/DialogStore';\nimport linq from 'linq';\n\nconst DialogInfoActionCreators = {\n  setDialogInfo(info) {\n    dispatch(ActionTypes.DIALOG_INFO_CHANGED, { info });\n\n\n\n    var peer = DialogStore.getCurrentPeer();\n    if (peer && peer.type === PeerTypes.GROUP) {\n      ActorClient.loadMembers(info.id, 10000, null).then((data) => {\n        if(info.members && info.members.length > 0) {\n          info.members = data.members;\n          info.adminId = linq.from(info.members).where('$.isAdmin === true').toArray()[0].peerInfo.peer.id;\n          dispatch(ActionTypes.DIALOG_INFO_CHANGED, { info });\n        }  \n      });\n    }\n\n\n    // function loadMembers(gid, size, next, members) {\n    //   if (next && next.length === 0) {\n    //     info.members = members;\n    //     dispatch(ActionTypes.DIALOG_INFO_CHANGED, { info });\n    //     return;\n    //   } else {\n    //     ActorClient.loadMembers(gid, size, next).then((data) => {\n    //       if (data.next.length >= 2 && data.next[1] < 0) {\n    //         data.next[1] = 256 + data.next[1];\n    //         data.next = data.next.splice(0, 2);\n    //       }\n    //       loadMembers(gid, size, data.next, members.concat(data.members));\n    //     })\n    //   }\n    //   return;    \n    // }\n  }\n};\n\nexport default DialogInfoActionCreators;\n"]}