{"version":3,"sources":["../../src/actions/VisibilityActionCreators.js"],"names":["VisibilityActionCreators","createAppVisible","isNotTj","APP_VISIBLE","onAppVisible","getProfile","undefined","ajax","url","type","data","JSON","stringify","userId","id","zxt","beforeSend","request","console","log","setRequestHeader","success","res","setBindings","bindConnectState","setState","createAppHidden","APP_HIDDEN","currentPeer","getCurrentPeer","saveDraft","onAppHidden","removeBindings"],"mappings":";;;;;;AAIA;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;+eAZA;;;;IAcMA,wB;;;;;;;;;AACJ;qCACAC,gB,6BAAiBC,O,EAAS;AACxB,sCAAS,+BAAYC,WAArB;AACA,0BAAYC,YAAZ;AACA;AACA,QAAI,uBAAaC,UAAb,OAA8BH,YAAY,KAAZ,IAAqBA,YAAYI,SAAjC,IAA8C,QAAOJ,OAAP,yCAAOA,OAAP,OAAmB,QAA/F,CAAJ,EAA8G;AAC5G,uBAAEK,IAAF,CAAO;AACLC,aAAK,mEADA;AAELC,cAAM,MAFD;AAGLC,cAAMC,KAAKC,SAAL,CAAe;AACnBC,kBAAQ,uBAAaR,UAAb,GAA0BS,EADf;AAEnBC,eAAK;AAFc,SAAf,CAHD;AAOLC,kBAPK,sBAOMC,OAPN,EAOe;AAChBC,kBAAQC,GAAR,CAAY,YAAZ,EAA0BF,OAA1B;AACAA,kBAAQG,gBAAR,CAAyB,cAAzB,EAAyC,iCAAzC;AACA;AACH,SAXI;;AAYLC,iBAAS,iBAACC,GAAD,EAAS;AAChBJ,kBAAQC,GAAR,CAAY,6BAAZ,EAA2CG,GAA3C;AACD;AAdI,OAAP;AAgBD;AACD,SAAKC,WAAL,CAAiB,SAAjB,EAA4B,CAC1B,sBAAYC,gBAAZ,CAA6B,wCAA8BC,QAA3D,CAD0B,CAA5B;AAGD,G;;qCAEDC,e,8BAAkB;AAChB,sCAAS,+BAAYC,UAArB;;AAEA,QAAMC,cAAc,sBAAYC,cAAZ,EAApB;AACA,kCAAoBC,SAApB,CAA8BF,WAA9B;;AAEA,0BAAYG,WAAZ;AACA,SAAKC,cAAL,CAAoB,SAApB;AACD,G;;;;;kBAGY,IAAIhC,wBAAJ,E","file":"VisibilityActionCreators.js","sourcesContent":["/*\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\n */\n\nimport { dispatch } from '../dispatcher/ActorAppDispatcher';\nimport { ActionTypes } from '../constants/ActorAppConstants';\nimport $ from 'jquery';\nimport ActionCreators from './ActionCreators';\nimport ConnectionStateActionCreators from '../actions/ConnectionStateActionCreators';\nimport DraftActionCreators from '../actions/DraftActionCreators';\nimport ActorClient from '../utils/ActorClient';\nimport DialogStore from '../stores/DialogStore';\nimport ProfileStore from '../stores/ProfileStore';\n\nclass VisibilityActionCreators extends ActionCreators {\n  // isNotTj 是否不统计\n  createAppVisible(isNotTj) {\n    dispatch(ActionTypes.APP_VISIBLE);\n    ActorClient.onAppVisible();\n    // 活跃度统计 20191205\n    if (ProfileStore.getProfile() && (isNotTj === false || isNotTj === undefined || typeof isNotTj === 'object')) {\n      $.ajax({\n        url: 'http://61.175.100.12:8801/zsgwuias/rest/out/subsystemClickFlyChat',\n        type: 'POST',\n        data: JSON.stringify({\n          userId: ProfileStore.getProfile().id,\n          zxt: '1196629848201199617'\n        }),\n        beforeSend(request) {\n            console.log('beforeSend', request);\n            request.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n            // request.setRequestHeader('SOAPActrin', 'http://eaglesoft/' + method);\n        },\n        success: (res) => {\n          console.log('统计结果=======================', res);\n        }\n      });\n    }\n    this.setBindings('connect', [\n      ActorClient.bindConnectState(ConnectionStateActionCreators.setState)\n    ]);\n  }\n\n  createAppHidden() {\n    dispatch(ActionTypes.APP_HIDDEN);\n\n    const currentPeer = DialogStore.getCurrentPeer();\n    DraftActionCreators.saveDraft(currentPeer);\n\n    ActorClient.onAppHidden();\n    this.removeBindings('connect');\n  }\n}\n\nexport default new VisibilityActionCreators();\n"]}