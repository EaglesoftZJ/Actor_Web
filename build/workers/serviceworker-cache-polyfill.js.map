{"version":3,"sources":["../../src/workers/serviceworker-cache-polyfill.js"],"names":["Cache","prototype","add","request","addAll","requests","cache","NetworkError","message","name","code","Object","create","Error","Promise","resolve","then","arguments","length","TypeError","map","Request","String","all","scheme","URL","url","protocol","fetch","clone","responses","response","i","put","undefined"],"mappings":";;AAAA,IAAI,CAACA,MAAMC,SAAN,CAAgBC,GAArB,EAA0B;AACxBF,QAAMC,SAAN,CAAgBC,GAAhB,GAAsB,SAASA,GAAT,CAAaC,OAAb,EAAsB;AAC1C,WAAO,KAAKC,MAAL,CAAY,CAACD,OAAD,CAAZ,CAAP;AACD,GAFD;AAGD;;AAED,IAAI,CAACH,MAAMC,SAAN,CAAgBG,MAArB,EAA6B;AAC3BJ,QAAMC,SAAN,CAAgBG,MAAhB,GAAyB,SAASA,MAAT,CAAgBC,QAAhB,EAA0B;AACjD,QAAIC,QAAQ,IAAZ;;AAEA;AACA,aAASC,YAAT,CAAsBC,OAAtB,EAA+B;AAC7B,WAAKC,IAAL,GAAY,cAAZ;AACA,WAAKC,IAAL,GAAY,EAAZ;AACA,WAAKF,OAAL,GAAeA,OAAf;AACD;AACDD,iBAAaN,SAAb,GAAyBU,OAAOC,MAAP,CAAcC,MAAMZ,SAApB,CAAzB;;AAEA,WAAOa,QAAQC,OAAR,GAAkBC,IAAlB,CAAuB,YAAW;AACvC,UAAIC,UAAUC,MAAV,GAAmB,CAAvB,EAA0B,MAAM,IAAIC,SAAJ,EAAN;;AAE1Bd,iBAAWA,SAASe,GAAT,CAAa,UAASjB,OAAT,EAAkB;AACxC,YAAIA,mBAAmBkB,OAAvB,EAAgC;AAC9B,iBAAOlB,OAAP;AACD,SAFD,MAGK;AACH,iBAAOmB,OAAOnB,OAAP,CAAP,CADG,CACqB;AACzB;AACF,OAPU,CAAX;;AASA,aAAOW,QAAQS,GAAR,CACLlB,SAASe,GAAT,CAAa,UAASjB,OAAT,EAAkB;AAC7B,YAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC/BA,oBAAU,IAAIkB,OAAJ,CAAYlB,OAAZ,CAAV;AACD;;AAED,YAAIqB,SAAS,IAAIC,GAAJ,CAAQtB,QAAQuB,GAAhB,EAAqBC,QAAlC;;AAEA,YAAIH,WAAW,OAAX,IAAsBA,WAAW,QAArC,EAA+C;AAC7C,gBAAM,IAAIjB,YAAJ,CAAiB,gBAAjB,CAAN;AACD;;AAED,eAAOqB,MAAMzB,QAAQ0B,KAAR,EAAN,CAAP;AACD,OAZD,CADK,CAAP;AAeD,KA3BM,EA2BJb,IA3BI,CA2BC,UAASc,SAAT,EAAoB;AAC1B;AACA;AACA,aAAOhB,QAAQS,GAAR,CACLO,UAAUV,GAAV,CAAc,UAASW,QAAT,EAAmBC,CAAnB,EAAsB;AAClC,eAAO1B,MAAM2B,GAAN,CAAU5B,SAAS2B,CAAT,CAAV,EAAuBD,QAAvB,CAAP;AACD,OAFD,CADK,CAAP;AAKD,KAnCM,EAmCJf,IAnCI,CAmCC,YAAW;AACjB,aAAOkB,SAAP;AACD,KArCM,CAAP;AAsCD,GAjDD;AAkDD","file":"serviceworker-cache-polyfill.js","sourcesContent":["if (!Cache.prototype.add) {\n  Cache.prototype.add = function add(request) {\n    return this.addAll([request]);\n  };\n}\n\nif (!Cache.prototype.addAll) {\n  Cache.prototype.addAll = function addAll(requests) {\n    var cache = this;\n\n    // Since DOMExceptions are not constructable:\n    function NetworkError(message) {\n      this.name = 'NetworkError';\n      this.code = 19;\n      this.message = message;\n    }\n    NetworkError.prototype = Object.create(Error.prototype);\n\n    return Promise.resolve().then(function() {\n      if (arguments.length < 1) throw new TypeError();\n\n      requests = requests.map(function(request) {\n        if (request instanceof Request) {\n          return request;\n        }\n        else {\n          return String(request); // may throw TypeError\n        }\n      });\n\n      return Promise.all(\n        requests.map(function(request) {\n          if (typeof request === 'string') {\n            request = new Request(request);\n          }\n\n          var scheme = new URL(request.url).protocol;\n\n          if (scheme !== 'http:' && scheme !== 'https:') {\n            throw new NetworkError('Invalid scheme');\n          }\n\n          return fetch(request.clone());\n        })\n      );\n    }).then(function(responses) {\n      // TODO: check that requests don't overwrite one another\n      // (don't think this is possible to polyfill due to opaque responses)\n      return Promise.all(\n        responses.map(function(response, i) {\n          return cache.put(requests[i], response);\n        })\n      );\n    }).then(function() {\n      return undefined;\n    });\n  };\n}\n"]}