{"version":3,"sources":["../../src/stores/CreateGroupStore.js"],"names":["CreateGroupStore","getInitialState","step","NAME_INPUT","name","search","selectedUserIds","OrderedSet","reduce","state","action","type","GROUP_CREATE_OPEN_IN_DIALOG","peer","getCurrentPeer","add","id","GROUP_CREATE_SET_NAME","CONTACTS_SELECTION","GROUP_CREATE_SET_SEARCH","GROUP_CREATE_SET_MEMBERS","GROUP_CREATE","CREATION_STARTED","GROUP_CREATE_SUCCESS","GROUP_CREATE_ERROR","console","error","GROUP_CREATE_MODAL_HIDE","getCurrentStep","getState","getGroupName","getGroupSearch","getSelectedUserIds"],"mappings":";;;;;;AAIA;;;;AAEA;;AACA;;;;AACA;;AAEA;;;;;;;;;;+eAVA;;;;IAYMA,gB;;;;;;;;;6BACJC,e,8BAAkB;AAChB,WAAO;AACLC,YAAM,oCAAiBC,UADlB;AAELC,YAAM,EAFD;AAGLC,cAAQ,EAHH;AAIL;AACAC,uBAAiB,IAAI,oBAAUC,UAAd;AALZ,KAAP;AAOD,G;;6BAEDC,M,mBAAOC,K,EAAOC,M,EAAQ;AACpB,YAAQA,OAAOC,IAAf;AACE,WAAK,+BAAYC,2BAAjB;AACA,YAAIC,OAAO,sBAAYC,cAAZ,EAAX;AACA,4BACKL,KADL;AAEEH,2BAAiBG,MAAMH,eAAN,CAAsBS,GAAtB,CAA0BF,KAAKG,EAA/B;AAFnB;AAIA,WAAK,+BAAYC,qBAAjB;AACE,4BACKR,KADL;AAEEP,gBAAM,oCAAiBgB,kBAFzB;AAGEd,gBAAMM,OAAON;AAHf;;AAMF,WAAK,+BAAYe,uBAAjB;AACE,4BACKV,KADL;AAEEP,gBAAM,oCAAiBgB,kBAFzB;AAGEb,kBAAQK,OAAOL;AAHjB;AAKF,WAAK,+BAAYe,wBAAjB;AACE,4BACKX,KADL;AAEEH,2BAAiBI,OAAOJ;AAF1B;;AAKF,WAAK,+BAAYe,YAAjB;AACE,4BACKZ,KADL;AAEEP,gBAAM,oCAAiBoB;;AAG3B;AALE,WAMF,KAAK,+BAAYC,oBAAjB;AACE,eAAO,KAAKtB,eAAL,EAAP;;AAEF,WAAK,+BAAYuB,kBAAjB;AACEC,gBAAQC,KAAR,CAAc,wBAAd,EAAwChB,OAAOgB,KAA/C;AACA,4BACKjB,KADL;AAEEP,gBAAM,oCAAiBsB;AAFzB;;AAKF,WAAK,+BAAYG,uBAAjB;AACE,eAAO,KAAK1B,eAAL,EAAP;;AAGF;AACE,eAAOQ,KAAP;AAhDJ;AAkDD,G;;6BAGCmB,c,6BAAiB;AACf,WAAO,KAAKC,QAAL,GAAgB3B,IAAvB;AACD,G;;6BAED4B,Y,2BAAe;AACb,WAAO,KAAKD,QAAL,GAAgBzB,IAAvB;AACD,G;;6BACD2B,c,6BAAiB;AACf,WAAO,KAAKF,QAAL,GAAgBxB,MAAvB;AACD,G;;6BAED2B,kB,iCAAqB;AACnB,WAAO,KAAKH,QAAL,GAAgBvB,eAAvB;AACD,G;;;;;kBAGU,IAAIN,gBAAJ,8B","file":"CreateGroupStore.js","sourcesContent":["/*\r\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport Immutable from 'immutable';\r\n\r\nimport { ReduceStore } from 'flux/utils';\r\nimport Dispatcher from '../dispatcher/ActorAppDispatcher';\r\nimport { ActionTypes, CreateGroupSteps } from '../constants/ActorAppConstants';\r\n\r\nimport DialogStore from '../stores/DialogStore';\r\n\r\nclass CreateGroupStore extends ReduceStore {\r\n  getInitialState() {\r\n    return {\r\n      step: CreateGroupSteps.NAME_INPUT,\r\n      name: '',\r\n      search: '',\r\n      // selectedUserIds: new Set()\r\n      selectedUserIds: new Immutable.OrderedSet()\r\n    };\r\n  }\r\n\r\n  reduce(state, action) {\r\n    switch (action.type) {\r\n      case ActionTypes.GROUP_CREATE_OPEN_IN_DIALOG:\r\n      var peer = DialogStore.getCurrentPeer();\r\n      return {\r\n        ...state,\r\n        selectedUserIds: state.selectedUserIds.add(peer.id)\r\n      }\r\n      case ActionTypes.GROUP_CREATE_SET_NAME:\r\n        return {\r\n          ...state,\r\n          step: CreateGroupSteps.CONTACTS_SELECTION,\r\n          name: action.name\r\n        }\r\n      \r\n      case ActionTypes.GROUP_CREATE_SET_SEARCH:\r\n        return {\r\n          ...state,\r\n          step: CreateGroupSteps.CONTACTS_SELECTION,\r\n          search: action.search\r\n        }\r\n      case ActionTypes.GROUP_CREATE_SET_MEMBERS:\r\n        return {\r\n          ...state,\r\n          selectedUserIds: action.selectedUserIds\r\n        }\r\n\r\n      case ActionTypes.GROUP_CREATE:\r\n        return {\r\n          ...state,\r\n          step: CreateGroupSteps.CREATION_STARTED\r\n        }\r\n\r\n      // TODO: Show create group error success messages in modal\r\n      case ActionTypes.GROUP_CREATE_SUCCESS:\r\n        return this.getInitialState();\r\n\r\n      case ActionTypes.GROUP_CREATE_ERROR:\r\n        console.error('Failed to create group', action.error);\r\n        return {\r\n          ...state,\r\n          step: CreateGroupSteps.GROUP_CREATE_ERROR\r\n        }\r\n\r\n      case ActionTypes.GROUP_CREATE_MODAL_HIDE:\r\n        return this.getInitialState();\r\n\r\n\r\n      default:\r\n        return state;\r\n    }\r\n  }\r\n\r\n\r\n    getCurrentStep() {\r\n      return this.getState().step;\r\n    }\r\n\r\n    getGroupName() {\r\n      return this.getState().name;\r\n    }\r\n    getGroupSearch() {\r\n      return this.getState().search;\r\n    }\r\n\r\n    getSelectedUserIds() {\r\n      return this.getState().selectedUserIds;\r\n    }\r\n}\r\n\r\nexport default new CreateGroupStore(Dispatcher);\r\n"]}